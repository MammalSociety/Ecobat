axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=3, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
##end code for Night graph
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages1)) {
print(ggplot(df, aes(x= Night, y= percentile))+
geom_point(df, size=3, shape = 1,
mapping = aes(x=Night, y= percentile, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=3, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
n_pages2 <- ceiling(nrow(unique(df[,c("species")]))/5)
unique(df[,c("species")]))
length(unique(df$species))
n_pages2 <- ceiling(nrow(unique(df[,c("species")]))/5)
n_pages2 <- ceiling(nrow(unique(df[,c("species")]))/4)
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages2)) {
print(ggplot(df, aes(x= Night, y= percentile))+
geom_point(df, size=3, shape = 1,
mapping = aes(x=Night, y= percentile, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
##end code for Night graph
locs<-length(unique(df$site_name))
#boxplot if 1 location
graphbox<-ggplot(df, aes(x=Spp, y=percentile))+ #add lines first
geom_hline(aes(yintercept=0), linetype="dashed", color="#000000") +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
geom_boxplot(df, mapping = aes(fill=species))+
xlab("Species")+
ylab("Bat Activity Level (Percentile)")+
scale_fill_grey(start = 0.35, end = 1)+
scale_x_discrete(drop=FALSE) +
scale_y_continuous(breaks=seq(0,100,20)) +
expand_limits(y=c(0,100))+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(linetype="blank"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90, face="italic", size=14, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=16),
legend.position="none")
graphbox
#endcode for boxplot
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages2)) {
print(ggplot(df, aes(x= Night, y= (median(percentile))))+
geom_point(df, size=3, shape = 1,
mapping = aes(x=Night, y= percentile, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
##end code for Night graph
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages2)) {
print(ggplot(df, aes(x= Night, y= percentile))+
geom_point(df, size=3, shape = 1,
mapping = aes(x=Night, y= percentile, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
##end code for Night graph
View(actdata2)
View(actdata)
medians <- df %>%
group_by(Night, Spp) %>%
mutate(med = median(percentile))
View(medians)
medians <- df %>%
group_by(Night, Spp) %>%
median(percentile)
class(df$percentile)
medians <- df %>%
group_by(Night, Spp) %>%
median(as.numeric(percentile))
df$percentiles <- as.numeric(df$percentile)
medians <- df %>%
group_by(Night, Spp) %>%
median(as.numeric(percentiles))
medians <- df %>%
group_by(Night, Spp) %>%
median(percentiles)
medians <- df %>%
group_by(Night, Spp) %>%
mutate(med = median(percentiles))
medians <- df %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles))
medians <- df %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles)) %>%
dplyr::arrange(Night, Spp)
medians <- df %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles)) %>%
dplyr::arrange(Night)
df$percentiles <- as.numeric(df$percentile)
medians <- df %>%
dplyr::filter
medians <- df %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles)) %>%
dplyr::arrange(Night)
medians <- df %>%
dplyr::select(location_name, Night, Spp, percentile) %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles)) %>%
dplyr::arrange(Night)
medians <- df %>%
dplyr::select(location_name, Night, Spp, percentiles) %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles)) %>%
dplyr::arrange(Night)
for (i in seq_len(n_pages2)) {
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(df, size=3, shape = 1,
mapping = aes(x=Night, y= percentile, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(df, size=3, shape = 1,
mapping = aes(x=Night, y= med, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(df, size=3, shape = 1,
color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(size=3, shape = 1,
color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(size=3, shape = 1,
color=activity_level)+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
medians <- df %>%
dplyr::select(location_name, Night, Spp, percentiles,
activity_level) %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles)) %>%
dplyr::arrange(Night)
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages2)) {
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(size=3, shape = 1,
color=activity_level)+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages2)) {
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(medians, size=3, shape = 1,
mapping = aes(x=Night, y= percentile, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
medians <- df %>%
dplyr::select(location_name, Night, Spp, percentiles,
activity_level, species) %>%
dplyr::group_by(Night, Spp) %>%
dplyr::mutate(med = median(percentiles)) %>%
dplyr::arrange(Night)
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages2)) {
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(medians, size=3, shape = 1,
mapping = aes(x=Night, y= percentile, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
## Night ~ percentile graph if 1 location, >1 species
#if time diff between 50 and 300 days
if((difftime(max(df$Night),min(df$Night), units='days')>50) & (difftime(max(df$Night),min(df$Night), units='days')<300) & locs=="1" & spn>1) {
for (i in seq_len(n_pages2)) {
print(ggplot(medians, aes(x= Night, y= med))+
geom_point(medians, size=3, shape = 1,
mapping = aes(x=Night, y= med, color=activity_level))+
xlab("Night")+ #set x-axis
ylab("Bat Activity Level (Percentile)")+
scale_colour_manual(values=cbbPalette, name="Activity\nLevel",
breaks=c("High","Moderate/High","Moderate",
"Low/Moderate","Low"))+
scale_y_continuous(breaks=seq(0,100,20), limits=c(0,100)) +
scale_x_date(name = "Date", date_breaks = "3 weeks", date_labels = "%d %b %y")+
theme_bw() +
theme(panel.grid.major = element_blank(),
panel.grid.minor = element_blank(),
panel.border = element_rect(colour="black", linetype="solid"),
axis.line=element_line(size=0.5, colour="black", linetype="solid"),
axis.title.x=element_text(size=18),
axis.text.x  = element_text(angle=90,size=16, hjust=1, vjust=0),
axis.text.y  = element_text(size=12),
axis.line.x = element_line(color="black", size = 0.5),
axis.line.y = element_line(color="black", size = 0.5),
axis.title.y=element_text(size=18)) +
geom_hline(aes(yintercept=20), linetype="dashed", color="#0072B2") +
geom_hline(aes(yintercept=40), linetype="dashed", color="#56B4E9") +
geom_hline(aes(yintercept=60), linetype="dashed", color="#009E73") +
geom_hline(aes(yintercept=80), linetype="dashed", color="#E69F00") +
facet_grid_paginate(species ~ ., ncol=1, nrow=4, scales="fixed", page=i) +
theme(strip.text.y = element_text(size=16, face="italic")))
}
}
##end code for Night graph
